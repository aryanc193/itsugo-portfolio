/* ============================================================= */
/*                  RESPONSIVE SCALE VARIABLES                   */
/* ============================================================= */

:root {
  --toggle-w: 60px;
  --toggle-h: 32px;
  --knob: 26px;
  --moon: 20px;
  --x-dark: 28px;
}

/* MOBILE */
@media (max-width: 480px) {
  :root {
    --toggle-w: 50px;
    --toggle-h: 27px;
    --knob: 22px;
    --moon: 17px;
    --x-dark: 22px;
  }
}

/* TABLET */
@media (max-width: 820px) {
  :root {
    --toggle-w: 54px;
    --toggle-h: 29px;
    --knob: 24px;
    --moon: 18px;
    --x-dark: 25px;
  }
}

/* Prevent weird collapse */
.wrapper {
  min-width: 42px;
  min-height: 22px;
}

/* ============================================================= */
/*                        MAIN WRAPPER                           */
/* ============================================================= */

.wrapper {
  flex-shrink: 0;      /* prevents shrinking in flex layouts */
  min-width: var(--toggle-w);
  position: relative;
  width: var(--toggle-w);
  height: var(--toggle-h);
  border-radius: 999px;
  padding: calc(var(--toggle-h) * 0.125);
  display: flex;
  align-items: center;
  cursor: pointer;
  overflow: hidden;
  background-color: #0a0f14;
  transition: background 0.3s ease, filter 0.3s ease;
}

/* Starry background in dark mode */
:global(html.dark) .wrapper {
  background-image: url("/darkmode/starrynight.jpg");
  background-size: cover;
  background-position: center;
  filter: saturate(0.9) brightness(1.15);
  animation: skyDrift 12s ease-in-out infinite alternate;
}

@keyframes skyDrift {
  0% {
    filter: brightness(1.1) saturate(0.9);
  }
  100% {
    filter: brightness(1.25) saturate(1.05);
  }
}

/* ============================================================= */
/*                            KNOB                                */
/* ============================================================= */

.knob {
  position: absolute;
  width: var(--knob);
  height: var(--knob);
  border-radius: 50%;
  background-color: #ffbb00;

  /* Glow & shadow */
  box-shadow: 3px 3px 15px 2px #ffbb00, 3px 3px 15px 2px #ffbb00;

  display: flex;
  align-items: center;
  justify-content: center;

  /* Transform controlled via CSS variable (fixes conflicts) */
  transform: translateX(var(--x, 0px));
  transition: transform 0.33s cubic-bezier(0.34, 1.56, 0.64, 1),
    box-shadow 0.6s ease;

  z-index: 10;
}

/* Physics sliding using variables */
.knobLight {
  --x: 0px;
  animation: slideLight 0.38s cubic-bezier(0.34, 1.56, 0.64, 1);
}
.knobDark {
  --x: var(--x-dark);
  animation: slideDark 0.38s cubic-bezier(0.34, 1.56, 0.64, 1);
}

@keyframes slideDark {
  0% {
    transform: translateX(0px);
  }
  80% {
    transform: translateX(calc(var(--x-dark) + 4px));
  }
  100% {
    transform: translateX(var(--x-dark));
  }
}

@keyframes slideLight {
  0% {
    transform: translateX(var(--x-dark));
  }
  80% {
    transform: translateX(-5px);
  }
  100% {
    transform: translateX(0px);
  }
}

/* Sun idle glow breathing (light mode only) */
.knobLight {
  animation: sunIdle 2.4s ease-in-out infinite;
}

@keyframes sunIdle {
  0% {
    box-shadow: 3px 3px 15px 2px rgba(255, 187, 0, 0.55);
  }
  50% {
    box-shadow: 3px 3px 22px 4px rgba(255, 187, 0, 0.85);
  }
  100% {
    box-shadow: 3px 3px 15px 2px rgba(255, 187, 0, 0.55);
  }
}

/* ============================================================= */
/*                         JOYBOY IMAGE                           */
/* ============================================================= */

.joy {
  width: calc(var(--knob) * 0.7);
  height: calc(var(--knob) * 0.7);
  transition: opacity 0.25s ease, transform 0.25s ease;
  opacity: 1;
}

.joyHidden {
  opacity: 0;
  transform: scale(0.8);
}

/* Jump animation when toggling to light mode */
.joyJump {
  animation: joyJump 0.8s ease forwards;
}

@keyframes joyJump {
  0% {
    transform: scale(0.3) translate(10px, 10px);
    opacity: 0;
  }
  30% {
    transform: scale(0.9) rotate(10deg);
    opacity: 1;
  }
  45% {
    transform: scale(0.9) rotate(-10deg);
  }
  70% {
    transform: scale(0.9) rotate(10deg);
  }
  100% {
    transform: scale(0.8) rotate(0deg);
  }
}

/* ============================================================= */
/*                             MOON                               */
/* ============================================================= */

.moon {
  position: absolute;
  width: var(--moon);
  height: var(--moon);
  border-radius: 50%;
  left: calc(100% - var(--moon) - 8px);
  top: 40%;
  transform: translateY(-50%) scale(0.9); /* keep your scale */

  background-image: url("/darkmode/Screenshot_2.png");
  background-size: contain;
  background-repeat: no-repeat;

  opacity: 0;
  transform: scale(0.9);
  transition: opacity 0.35s ease, transform 0.35s ease;

  /* Subtle base glow */
  filter: drop-shadow(0 0 calc(var(--moon) * 0.25) rgba(200, 220, 255, 0.5))
    drop-shadow(0 0 calc(var(--moon) * 0.5) rgba(150, 180, 255, 0.35));

  z-index: 50;
}

.moonVisible {
  opacity: 1;
  transform: translateY(-50%) scale(1);
  filter: drop-shadow(0 0 calc(var(--moon) * 0.3) rgba(180, 220, 255, 0.6))
    drop-shadow(0 0 calc(var(--moon) * 0.6) rgba(140, 200, 255, 0.45));
}
